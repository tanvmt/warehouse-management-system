syntax = "proto3";

option java_multiple_files = true;
option java_package = "com.group9.warehouse.grpc";
option java_outer_classname = "WarehouseProto";

service WarehouseService {
  rpc Login(LoginRequest) returns (LoginResponse) {}
  rpc GetProducts(EmptyRequest) returns (ProductListResponse) {}
  rpc AddProduct(AddProductRequest) returns (ServiceResponse) {}
  rpc GetInventory(EmptyRequest) returns (InventoryResponse) {}
  rpc ImportProduct(TransactionRequest) returns (TransactionResponse) {}
  rpc ExportProduct(TransactionRequest) returns (TransactionResponse) {}
  rpc GetHistory(EmptyRequest) returns (HistoryResponse) {}
  rpc GetUsers (EmptyRequest) returns (UserListResponse) {}
  rpc AddUser (AddUserRequest) returns (ServiceResponse) {}
  rpc DeleteUser (DeleteUserRequest) returns (ServiceResponse) {}
  rpc GetUserProfile(GetProfileRequest) returns (ProfileResponse);
  rpc UpdateUserProfile(UpdateProfileRequest) returns (ProfileResponse);
  rpc ChangePassword(ChangePasswordRequest) returns (ProfileResponse);
  rpc SetUserActiveStatus(SetUserActiveRequest) returns (ProfileResponse);
}

message EmptyRequest {}

message User {
  string username = 1;
  string role = 2; 
}

message UserListResponse {
  repeated User users = 1;
}

message AddUserRequest {
  string username = 1;
  string password = 2;
  string role = 3; 
}

message DeleteUserRequest {
  string username = 1;
}

message UserProfile {
    string username = 1;
    string role = 2;
    string fullName = 3;
    string email = 4;
    string phone = 5;
    string sex = 6;
    string dateOfBirth = 7; 
    bool isActive = 8;
}

message GetProfileRequest {
    string username = 1;
}

message UpdateProfileRequest {
    UserProfile profile = 1;
}

message ChangePasswordRequest {
    string username = 1;
    string oldPassword = 2;
    string newPassword = 3;
}

message ProfileResponse {
    bool success = 1;
    string message = 2;
    UserProfile profile = 3;
}

message SetUserActiveRequest {
    string username = 1;
    bool isActive = 2;
}

message Product {
  string productId = 1;
  string productName = 2;
}

message InventoryItem {
  string productName = 1;
  int32 quantity = 2;
}

message Transaction {
    string timestamp = 1;
    string clientName = 2;
    string action = 3;
    string product = 4;
    int32 quantity = 5;
    string result = 6;
}

message LoginRequest {
  string username = 1;
  string password = 2;
}

message LoginResponse {
  bool success = 1;
  string message = 2; 
  string role = 3;   
}

message ProductListResponse {
  repeated Product products = 1;
}

message AddProductRequest {
  string productId = 1;
  string productName = 2;
}

message ServiceResponse { 
  bool success = 1;
  string message = 2;
}

message InventoryResponse {
  repeated InventoryItem items = 1;
}

message TransactionRequest {
  string clientName = 1; 
  string productId = 2; 
  int32 quantity = 3;
}

message TransactionResponse {
  bool success = 1;
  string message = 2; 
  int32 newQuantity = 3;
}

message HistoryResponse {
  repeated Transaction transactions = 1;
}