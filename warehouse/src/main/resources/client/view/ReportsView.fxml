<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.BarChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?> <?import javafx.scene.control.SplitPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>
<?import org.kordamp.ikonli.javafx.FontIcon?>

<ScrollPane fx:id="mainScrollPane" styleClass="root-pane" fitToWidth="true" xmlns="http://javafx.com/javafx/11" xmlns:fx="http://javafx.com/fxml/1" fx:controller="client.controller.ReportsController">
    <padding>
        <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
    </padding>
    
    <content>
        <VBox spacing="10.0" fx:id="mainVBox">
            <children>
                <Label styleClass="title-label" text="Báo cáo Kho hàng" />
                
                <HBox spacing="10.0" alignment="BOTTOM_LEFT" styleClass="card">
                    <VBox>
                        <Label styleClass="field-label" text="Từ ngày" />
                        <DatePicker fx:id="startDatePicker" />
                    </VBox>
                    <VBox>
                        <Label styleClass="field-label" text="Đến ngày" />
                        <DatePicker fx:id="endDatePicker" />
                    </VBox>
                    
                    <Button fx:id="filterButton" onAction="#handleFilterButton" styleClass="primary-button" text="Lọc dữ liệu" HBox.hgrow="ALWAYS">
                        <graphic>
                            <FontIcon iconLiteral="fas-filter" />
                        </graphic>
                    </Button>
                    
                    <Button fx:id="exportPdfButton" onAction="#handleExportPdf" styleClass="secondary-button" text="Xuất PDF" disable="true">
                         <graphic>
                            <FontIcon iconLiteral="fas-file-pdf" />
                         </graphic>
                    </Button>
                </HBox>
                
                <SplitPane dividerPositions="0.45" orientation="VERTICAL" VBox.vgrow="ALWAYS">
                    <items>
                        <HBox spacing="20.0">
                            <VBox styleClass="card" HBox.hgrow="ALWAYS">
                                <Label styleClass="card-title" text="Tỷ lệ Tồn kho Sản phẩm" />
                                <PieChart fx:id="inventoryPieChart" title="Tỷ lệ Tồn kho" VBox.vgrow="ALWAYS" />
                            </VBox>
                            <VBox styleClass="card" HBox.hgrow="ALWAYS">
                                <Label styleClass="card-title" text="Thống kê Nhập/Xuất (Theo ngày lọc)" />
                                <BarChart fx:id="activityBarChart" title="Hoạt động Nhập/Xuất" VBox.vgrow="ALWAYS" animated="false">
                                    <xAxis>
                                        <CategoryAxis label="Hoạt động" />
                                    </xAxis>
                                    <yAxis>
                                        <NumberAxis label="Số lượng" />
                                    </yAxis>
                                </BarChart>
                            </VBox>
                        </HBox>
                        
                        <VBox styleClass="card" spacing="10.0" VBox.vgrow="ALWAYS" maxHeight="Infinity">
                            <Label styleClass="card-title" text="Bảng Tổng hợp Nhập/Xuất (Theo ngày lọc)" />
                            
                            <TableView fx:id="summaryTable" VBox.vgrow="ALWAYS">
                                <columns>
                                    <TableColumn fx:id="sumProductCol" prefWidth="400.0" text="Sản phẩm" />
                                    <TableColumn fx:id="sumImportCol" prefWidth="180.0" text="Tổng Nhập" />
                                    <TableColumn fx:id="sumExportCol" prefWidth="180.0" text="Tổng Xuất" />
                                    <TableColumn fx:id="sumInventoryCol" prefWidth="150.0" text="Tồn kho hiện tại" />
                                </columns>
                                <columnResizePolicy>
                                    <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                </columnResizePolicy>
                            </TableView>
                        </VBox>
                    </items>
                </SplitPane>
            </children>
        </VBox>
    </content>
</ScrollPane>